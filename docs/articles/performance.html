<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resource usage â€¢ easyshiny</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Resource usage">
<meta property="og:description" content="easyshiny">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">easyshiny</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/building.html">Building apps</a>
    </li>
    <li>
      <a href="../articles/deploy.html">Deploying your app</a>
    </li>
    <li>
      <a href="../articles/performance.html">Resource usage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Versions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nbisweden/easyshiny">
    <span class="fa fa-github fa-lg fas"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Resource usage</h1>
                        <h4 data-toc-skip class="author">Roy
Francis</h4>
            
            <h4 data-toc-skip class="date">12-Apr-2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nbisweden/easyshiny/blob/HEAD/vignettes/performance.Rmd"><code>vignettes/performance.Rmd</code></a></small>
      <div class="hidden name"><code>performance.Rmd</code></div>

    </div>

    
    
<p><strong>easyshiny</strong> is intended as quick solution for small to
medium scale datasets. It is not built for hundred-thousands or million
cell scale. For that, see <a href="https://cellxgene.cziscience.com/" class="external-link">cellxgene</a> for example. In
this vignette, we will look at RAM requirements and cell numbers.</p>
<p>A sample dataset with 400,000 cells was downsampled to different
number of cells to evaluate memory usage. When building the app, the
memory used was estimated using the <code><a href="https://rdrr.io/pkg/pryr/man/mem_change.html" class="external-link">pryr::mem_change()</a></code>
function. Once the app is built, it is run inside <code>profvis()</code>
to estimate run time memory usage as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="fu">profvis</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="st">"app"</span>, launch.browser <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">htmlwidgets</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmlwidgets/man/saveWidget.html" class="external-link">saveWidget</a></span><span class="op">(</span><span class="va">pv</span>, <span class="st">"app.html"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/browseURL.html" class="external-link">browseURL</a></span><span class="op">(</span><span class="st">"app.html"</span><span class="op">)</span></span></code></pre></div>
<p>This table shows the number of cells in the downsampled dataset and
the memory usage during build and runtime in GB.</p>
<table class="table">
<thead><tr class="header">
<th align="right">cells</th>
<th align="right">features</th>
<th align="right">mem_build_gb</th>
<th align="right">mem_app_gb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">800</td>
<td align="right">26349</td>
<td align="right">0.083</td>
<td align="right">0.1367188</td>
</tr>
<tr class="even">
<td align="right">5868</td>
<td align="right">26349</td>
<td align="right">0.604</td>
<td align="right">0.2490234</td>
</tr>
<tr class="odd">
<td align="right">16664</td>
<td align="right">26349</td>
<td align="right">1.760</td>
<td align="right">0.5507812</td>
</tr>
<tr class="even">
<td align="right">33974</td>
<td align="right">26349</td>
<td align="right">3.590</td>
<td align="right">0.9912109</td>
</tr>
<tr class="odd">
<td align="right">73069</td>
<td align="right">26349</td>
<td align="right">7.710</td>
<td align="right">3.1748047</td>
</tr>
<tr class="even">
<td align="right">126738</td>
<td align="right">26349</td>
<td align="right">13.400</td>
<td align="right">3.5537109</td>
</tr>
<tr class="odd">
<td align="right">206197</td>
<td align="right">26349</td>
<td align="right">21.700</td>
<td align="right">5.2568359</td>
</tr>
<tr class="even">
<td align="right">403474</td>
<td align="right">26349</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>The full 400,000 cell dataset could not be built on my system as it
required more than 40GB of RAM.</p>
<p>This table is visualised as a scatterplot. A linear model was fitted
to the points.</p>
<p><img src="images/memory.jpg"></p>
<p>The build memory usage (in GB) can be estimated from the number of
cells as follows:</p>
<pre><code><span><span class="va">build_memory_usage_gb</span> <span class="op">=</span> <span class="fl">5.003e-03</span> <span class="op">+</span> <span class="op">(</span><span class="va">number_of_cells</span> <span class="op">*</span> <span class="fl">1.054e-04</span><span class="op">)</span></span></code></pre>
<p>The app memory usage (in GB) can be estimated from the number of
cells as follows:</p>
<pre><code><span><span class="va">app_memory_usage_gb</span> <span class="op">=</span> <span class="fl">2.912e-01</span> <span class="op">+</span> <span class="op">(</span><span class="va">number_of_cells</span> <span class="op">*</span> <span class="fl">2.563e-05</span><span class="op">)</span></span></code></pre>
<p>Note that it is unknown if the data can be extrapolated beyond the
range. Also note the test data has 26349 features.</p>
<p>Apart from memory usage, it is worth noting that the usability of the
app is also affected by CPU. On my system, roughly 100,000 cells was the
limit of smooth interaction with widgets. Beyond that, the app was slow
to respond and there was appreciable delay between widget adjustment and
updating of plots.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://royfrancis.com" class="external-link">Roy Francis</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
